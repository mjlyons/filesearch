This is a work in progress, and there's a lot of sloppy code.

That said, it seems to work and is really fast.

